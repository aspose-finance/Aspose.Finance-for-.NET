function showLoader(){$(".progress > .progress-bar").html("15%");$(".progress > .progress-bar").css("width","15%");$("#loader").removeClass("hidden");hideAlert()}function hideLoader(){$("#loader").addClass("hidden")}function generateViewerLink(n){var t=n.FolderName!==undefined?n.FolderName:n.id;return encodeURI(o.ViewerPath+"FileName="+n.FileName+"&FolderName="+t+"&CallbackURL="+o.AppURL)}function generateEditorLink(n){var t=n.FolderName!==undefined?n.FolderName:n.id;return encodeURI(o.EditorPath+"FileName="+n.FileName+"&FolderName="+t+"&CallbackURL="+o.AppURL)}function sendPageView(n){if("ga"in window)try{var t=ga.getAll()[0];t!==undefined&&t.send("pageview",n)}catch(i){}}function workSuccess(n){if(hideLoader(),n.StatusCode===200){if(n.FileProcessingErrorCode!==undefined&&n.FileProcessingErrorCode!==0){showAlert(o.FileProcessingErrorCodes[n.FileProcessingErrorCode]);return}if($("#WorkPlaceHolder").addClass("hidden"),$(".appfeaturesectionlist").addClass("hidden"),$(".howtolist").addClass("hidden"),$(".app-features-section").addClass("hidden"),$(".app-product-section").addClass("hidden"),$("#DownloadPlaceHolder").removeClass("hidden"),$("#OtherApps").removeClass("hidden"),o.ReturnFromViewer===undefined){const n=o.AppDownloadURL.indexOf("?"),t=n===-1?o.AppDownloadURL:o.AppDownloadURL.substring(0,n);sendPageView(t)}var t=encodeURI(o.APIBasePath+`Common/DownloadFile/${n.FolderName}?file=${n.FileName}`);if($("#DownloadButton").attr("href",t),o.DownloadUrl=t,o.ShowViewerButton){let t=$("#ViewerLink"),i=n.FileName.lastIndexOf("."),r=i>=0?n.FileName.substring(i+1).toUpperCase():null;if(r!==null&&t.length&&VIEWABLE_EXTENSIONS.indexOf(r)!==-1)t.on("click",function(t){t.preventDefault();t.stopPropagation();openIframe(generateViewerLink(n),"/words/viewer","/words/view")});else t.hide(),$(t[0].parentNode.previousElementSibling).hide()}}else showAlert(n.Status)}function sendEmail(){var n=$("#EmailToInput").val(),t;if(!n||!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase())){window.alert("Please specify the valid email address!");return}t={appname:o.AppName,email:n,url:o.DownloadUrl,title:$("#ProductTitle")[0].innerText};$("#sendEmailModal").modal("hide");$("#sendEmailButton").addClass("hidden");$.ajax({method:"POST",url:"/words/sendemail",data:t,dataType:"json",success:n=>{showMessage(n.message)},complete:()=>{$("#sendEmailButton").removeClass("hidden"),hideLoader()},error:n=>{showAlert(n.responseJSON.message)}})}function sendFeedback(n){var t=typeof n=="string"?n:$("#feedbackText").val(),r,i;if(t&&!t.match(/^\s+$/)&&!(t.length>1e3)){if(r={appname:o.AppName,text:t},!n&&"ga"in window)try{i=window.ga.getAll()[0];i!==undefined&&i.send("event",{eventCategory:"Social",eventAction:"feedback-in-download"})}catch(u){}$.ajax({method:"POST",url:"/words/sendfeedback",data:r,dataType:"json",success:n=>{showMessage(n.message),$("#feedback").hide()},error:n=>{showAlert(n.responseJSON.message)}})}}function hideAlert(){$("#alertMessage").addClass("hidden");$("#alertMessage").text("");$("#alertSuccess").addClass("hidden");$("#alertSuccess").text("")}function showAlert(n){hideLoader();$("#alertMessage").html(n);$("#alertMessage").removeClass("hidden");$("#alertMessage").fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100)}function showMessage(n){hideLoader();$("#alertSuccess").text(n);$("#alertSuccess").removeClass("hidden")}function progress(n){if(n.lengthComputable){var i=n.total,r=n.loaded,t=Math.round(r*100/i);t=(t<15?15:t)+"%";$(".progress > .progress-bar").html(t);$(".progress > .progress-bar").css("width",t)}}function removeAllFileBlocks(){fileDrop.droppedFiles.forEach(function(n){$("#fileupload-"+n.id).remove()});fileDrop.droppedFiles=[];hideLoader()}function openIframe(n,t,i){window.history.pushState(null,null,t);$("body").css("overflow-y","hidden");var r=$('<div id="iframe-wrap"><\/div>');$("<iframe>",{src:n,id:"iframe-document",frameborder:0,scrolling:"yes"}).appendTo(r);r.appendTo("body");sendPageView(i)}function closeIframe(){removeAllFileBlocks();$("div#iframe-wrap").remove();$("body").css("overflow-y","auto")}function request(n,t){showLoader();$.ajax({method:"POST",url:n,data:t,processData:!1,contentType:!1,cache:!1,timeout:6e5,success:workSuccess,xhr:function(){var n=$.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",progress,!1),n},error:function(n){n.data!==undefined&&n.data.Status!==undefined?showAlert(n.data.Status):showAlert("Error "+n.status+": "+n.statusText)}})}function requestMerger(){let n=fileDrop.prepareFormData(2,o.MaximumUploadFiles);if(n!==null){let t=o.APIBasePath+"AsposeWordsMerger/Merge?outputType="+$("#saveAs").val();request(t,n)}}function requestParser(){let n=fileDrop.prepareFormData();if(n!==null){let t=o.APIBasePath+"AsposeWordsParser/Parse";request(t,n)}}function requestAnnotation(){let n=fileDrop.prepareFormData();if(n!==null){let t=o.APIBasePath+"AsposeWordsAnnotation/Remove";request(t,n)}}function requestConversion(){let n=fileDrop.prepareFormData();if(n!==null){let t=o.APIBasePath+"AsposeWordsConversion/Convert?outputType="+$("#saveAs").val();request(t,n)}}function requestMetadata(n){let t=o.APIBasePath+"AsposeWordsMetadata/properties";$.ajax({method:"POST",url:t,data:JSON.stringify(n),contentType:"application/json",cache:!1,timeout:6e5,success:t=>{$.metadata(t,n.id,n.FileName)},error:n=>{n.data!==undefined&&n.data.Status!==undefined?showAlert(n.data.Status):showAlert("Error "+n.status+": "+n.statusText)}})}function requestRedaction(){if(validateSearch()){let n=fileDrop.prepareFormData();if(n!==null){let t=o.APIBasePath+"AsposeWordsRedaction/Redact?outputType="+$("#saveAs").val()+"&searchQuery="+encodeURI($("#searchQuery").val())+"&replaceText="+encodeURI($("#replaceText").val())+"&caseSensitive="+$("#caseSensitive").prop("checked")+"&text="+$("#text").prop("checked")+"&comments="+$("#comments").prop("checked")+"&metadata="+$("#metadata").prop("checked");request(t,n)}}}function validateSearch(){return $("#searchQuery").val().length?!0:(showAlert(o.validationSearchMessage),!1)}function requestSearch(){if(validateSearch()){let n=fileDrop.prepareFormData();if(n!==null){let t=o.APIBasePath+"AsposeWordsSearch/Search?query="+encodeURI($("#searchQuery").val());request(t,n)}}}function validateUnlock(){return $("#passw").val().length?!0:(showAlert(o.validationMessage),!1)}function requestUnlock(){if(validateUnlock()){let n=fileDrop.prepareFormData();if(n!==null){let t=o.APIBasePath+"AsposeWordsUnlock/Unlock?passw="+encodeURI($("#passw").val())+"&outputType="+$("#saveAs").val();request(t,n)}}}function validateComparison(){return fileDrop.droppedFiles.length===1&&fileDrop.droppedFiles.length===1?!0:(showAlert(o.FileSelectMessage),!1)}function requestComparison(){if(validateComparison()){let n=fileDrop.prepareFormData();if(n!==null){let t=fileDrop2.prepareFormData();if(t!==null){for(var i of t.entries())n.append(i[0],i[1]);let r=o.APIBasePath+"AsposeWordsComparison/Compare";request(r,n)}}}}function requestViewer(n){var t=generateViewerLink(n);openIframe(t,"/words/viewer","/words/view")}function requestEditor(n){var t=generateEditorLink(n);openIframe(t,"/words/editor","/words/edit")}function prepareDownloadUrl(){o.AppDownloadURL=o.AppURL;var n=o.AppDownloadURL.indexOf(":");n>0&&(o.AppDownloadURL=(n>0?o.AppDownloadURL.substring(n+3):o.AppURL)+"/download");n=o.AppDownloadURL.indexOf("/");o.AppDownloadURL=o.AppDownloadURL.substring(n)}function checkReturnFromViewer(){var i=window.location.search,n,t;i.length>0&&(o.ReturnFromViewer=!0,n={StatusCode:200,FolderName:$.QueryString.id,FileName:$.QueryString.FileName,FileProcessingErrorCode:0},t=window.location.href.split("?")[0],window.history.pushState({},document.title,t),o.UploadAndRedirect||workSuccess(n))}function shareApp(n){var i,t;if(["facebook","twitter","linkedin","cloud","feedback","otherapp","bookmark"].indexOf(n)!==-1){var u=function(n,t){if(t||(t="Social"),"ga"in window)try{var i=window.ga.getAll()[0];i!==undefined&&i.send("event",{eventCategory:t,eventAction:n})}catch(r){}},f=window.location.pathname.split("/"),r="https://"+window.location.hostname+"/words/"+f[2],e=document.title.replace("&","and");u(n.charAt(0).toUpperCase()+n.slice(1));switch(n){case"facebook":t=document.createElement("a");t.href="https://www.facebook.com/sharer/sharer.php?u=#"+encodeURI(r);t.setAttribute("target","_blank");t.click();break;case"twitter":t=document.createElement("a");t.href="https://twitter.com/intent/tweet?text="+encodeURI(e)+"&url="+encodeURI(r);t.setAttribute("target","_blank");t.click();break;case"linkedin":t=document.createElement("a");t.href="https://www.linkedin.com/sharing/share-offsite/?url="+encodeURI(r);t.setAttribute("target","_blank");t.click();break;case"feedback":$("#feedbackModal").modal({keyboard:!0});break;case"otherapp":document.location.href="https://products.aspose.app/words/family";break;case"cloud":i=i||window.event;i=i.target||i.srcElement;i.tagName!=="A"&&(t=document.createElement("a"),t.href="https://products.aspose.cloud/words/family",t.setAttribute("target","_blank"),t.click());break;case"bookmark":$("#bookmarkModal").modal({keyboard:!0})}}}function sendFeedbackExtended(){var n=$("#feedbackBody").val();n&&!n.match(/^.s+$/)&&($("#feedbackModal").modal("hide"),sendFeedback(n))}function otherAppClick(n,t=false){if("ga"in window)try{var i=window.ga.getAll()[0];i!==undefined&&i.send("event",{eventCategory:"Other App Click"+(t?" Left":""),eventAction:n})}catch(r){}}const VIEWABLE_EXTENSIONS=["DOC","DOCX","DOCM","DOT","DOTX","DOTM","RTF","HTML","MHTML","MOBI","ODT","OTT","TXT"];var fileDrop={},fileDrop2={};$.extend($.expr[":"],{isEmpty:function(n){return n.value===""}}),function(n){n.fn.inputFilter=function(n){return this.on("input keydown keyup mousedown mouseup select contextmenu drop",function(){n(this.value)?(this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")?(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd)):this.value=""})}}(jQuery),function(n){n.QueryString=function(n){let t={};for(let i=0;i<n.length;++i){let r=n[i].split("=",2);r.length===2&&(t[r[0]]=decodeURIComponent(r[1].replace(/\+/g," ")))}return t}(window.location.search.substr(1).split("&"))}(jQuery);$(document).ready(function(){if(prepareDownloadUrl(),checkReturnFromViewer(),fileDrop=$("form#UploadFile").filedrop(Object.assign({showAlert:showAlert,hideAlert:hideAlert,showLoader:showLoader,progress:progress},o)),o.AppName==="Comparison"&&(fileDrop2=$("form#UploadFile").filedrop(Object.assign({showAlert:showAlert,hideAlert:hideAlert,showLoader:showLoader,progress:progress},o))),window.onpopstate=function(){$("div#iframe-wrap").length>0&&closeIframe()},!o.UploadAndRedirect)$("#uploadButton").on("click",o.Method);$("#bookmarkModal").on("show.bs.modal",function(){$("#bookmarkModal").css("display","flex");$("#bookmarkModal").on("keydown",function(n){(n.metaKey||n.ctrlKey)&&String.fromCharCode(n.which).toLowerCase()==="d"&&$("#bookmarkModal").modal("hide")})});$("#bookmarkModal").on("hidden.bs.modal",function(){$("#bookmarkModal").off("keydown")});$("#sendEmailButton").on("click",function(){$("#sendEmailModal").modal({keyboard:!0})});$("#sendEmailModal").on("show.bs.modal",function(){$("#sendEmailModal").css("display","flex")});$("#sendEmailModal").on("shown.bs.modal",function(){$("#EmailToInput").focus()});$("#feedbackModal").on("show.bs.modal",function(){$("#feedbackModal").css("display","flex")});$("#feedbackModal").on("shown.bs.modal",function(){$("#feedbackBody").focus()});$(document).on("keydown",function(n){if(n.originalEvent.code==="KeyD"&&n.originalEvent.ctrlKey&&!n.originalEvent.altKey&&!n.originalEvent.shiftKey&&!n.originalEvent.metaKey&&"ga"in window)try{var t=window.ga.getAll()[0];t!==undefined&&t.send("event",{eventCategory:"[Ctrl + D] keypress",eventAction:"Target: "+window.location.pathname})}catch(i){}})});